# [30024] ì˜¥ìˆ˜ìˆ˜ë°­

### **ë‚œì´ë„**
ê³¨ë“œ 4
## **ðŸ“ë¬¸ì œ**
ì˜¥ìˆ˜ìˆ˜ë°­ ì£¼ì¸ ë¯¼ì„ì´ëŠ” í•œ í•´ ë™ì•ˆ ì—´ì‹¬ížˆ ê¸°ë¥¸ ì˜¥ìˆ˜ìˆ˜ë¥¼ ìˆ˜í™•í•˜ë ¤ê³  í•œë‹¤. ì˜¥ìˆ˜ìˆ˜ë°­ì€ 
$N$í–‰ 
$M$ì—´ì˜ ê²©ìžë¡œ ìƒê°í•  ìˆ˜ ìžˆëŠ”ë°, ê²©ìžì˜ ê° ì¹¸ì—ëŠ” í•œ ê·¸ë£¨ì˜ ì˜¥ìˆ˜ìˆ˜ê°€ ì‹¬ì–´ì ¸ ìžˆë‹¤. ë¯¼ì„ì´ëŠ” ê° ì˜¥ìˆ˜ìˆ˜ì˜ ê°€ì¹˜ë¥¼ ì¸¡ì •í•´ì„œ ì„œë¡œ ë‹¤ë¥¸ ì •ìˆ˜ 
$1,2,\cdots ,N\times M$ì„ ë¶€ì—¬í–ˆë‹¤.

![ì´ë¯¸ì§€](https://upload.acmicpc.net/8bfc31ad-3ecd-4a0b-aafe-9ef98a081e27/-/preview/)

ë¯¼ì„ì´ëŠ” ì²˜ìŒì— ì˜¥ìˆ˜ìˆ˜ë°­ ë°”ê¹¥ì— ìœ„ì¹˜í•œë‹¤. ë¯¼ì„ì´ëŠ” ì˜¥ìˆ˜ìˆ˜ë°­ ë°”ê¹¥ì„ ëŒì•„ë‹¤ë‹ˆë©´ì„œ ì˜¥ìˆ˜ìˆ˜ë°­ ë°”ê¹¥ê³¼ ì¸ì ‘í•œ ì¹¸ì˜ ì˜¥ìˆ˜ìˆ˜ë¥¼ ìˆ˜í™•í•  ìˆ˜ ìžˆë‹¤. ë˜ëŠ” ì˜¥ìˆ˜ìˆ˜ë°­ ì•ˆì—ì„œ ì˜¥ìˆ˜ìˆ˜ë¥¼ ìˆ˜í™•í•œ ì¹¸ìœ¼ë¡œë§Œ ëŒì•„ë‹¤ë‹ˆë©´ì„œ í˜„ìž¬ ìœ„ì¹˜í•œ ì¹¸ì—ì„œ ìƒí•˜ì¢Œìš°ë¡œ ì¸ì ‘í•œ ì¹¸ì˜ ì˜¥ìˆ˜ìˆ˜ë¥¼ ìˆ˜í™•í•  ìˆ˜ ìžˆë‹¤.

ê·¸ëŸ°ë°, ë¯¼ì„ì´ëŠ” ì˜¥ìˆ˜ìˆ˜ì˜ ìƒì‚°ëŸ‰ ì¡°ì ˆì„ ìœ„í•´ì„œ 
$K$ê·¸ë£¨ì˜ ì˜¥ìˆ˜ìˆ˜ë§Œ ìˆ˜í™•í•˜ë ¤ê³  í•œë‹¤. ë¯¼ì„ì´ëŠ” í˜„ìž¬ ìˆ˜í™•í•  ìˆ˜ ìžˆëŠ” ì˜¥ìˆ˜ìˆ˜ ì¤‘ì—ì„œ ê°€ìž¥ ê°€ì¹˜ê°€ ë†’ì€ ì˜¥ìˆ˜ìˆ˜ë¥¼ ìˆ˜í™•í•˜ëŠ” ê³¼ì •ì„ 
$K$ë²ˆ ë°˜ë³µí•œë‹¤. ë¯¼ì„ì´ê°€ ìˆ˜í™•í•˜ëŠ” ì˜¥ìˆ˜ìˆ˜ì˜ ìœ„ì¹˜ë¥¼ ìˆœì„œëŒ€ë¡œ êµ¬í•´ë³´ìž.
### **ìž…ë ¥**
ì²«ì§¸ ì¤„ì— ì •ìˆ˜ 
$N, M(1 \le N, M \le 1\,000)$ì´ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ë˜ì–´ ì£¼ì–´ì§„ë‹¤.

ë‘˜ì§¸ ì¤„ë¶€í„° 
$N$ê°œì˜ ì¤„ì— ê±¸ì³ 
$M$ê°œì˜ ì •ìˆ˜ê°€ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ë˜ì–´ ì£¼ì–´ì§„ë‹¤. 
$N$ê°œì˜ ì¤„ ì¤‘ 
$i$ë²ˆì§¸ ì¤„ì˜ 
$j$ë²ˆì§¸ ì •ìˆ˜ëŠ” ê²©ìžì—ì„œ 
$i$ë²ˆì§¸ ì¤„ì˜ 
$j$ë²ˆì§¸ ì¹¸ì˜ ì˜¥ìˆ˜ìˆ˜ì˜ ê°€ì¹˜ë¥¼ ì˜ë¯¸í•˜ëŠ” ì •ìˆ˜ 
$a_{ij}(1 \le a_{ij} \le N \times M)$ë‹¤.

ë§ˆì§€ë§‰ ì¤„ì— ì •ìˆ˜ 
$K(1\le K \le \min(N \times M, 100\,000))$ê°€ ì£¼ì–´ì§„ë‹¤.
### **ì¶œë ¥**
$K$ê°œì˜ ì¤„ì— ë¯¼ì„ì´ê°€ ìˆ˜í™•í•˜ëŠ” ì˜¥ìˆ˜ìˆ˜ì˜ ìœ„ì¹˜ 
$i,j(1\le i\le N;1\le j\le M)$ë¥¼ ìˆœì„œëŒ€ë¡œ ì¶œë ¥í•œë‹¤. 
$i,j$ëŠ” ê²©ìžì˜ 
$i$ë²ˆì§¸ í–‰, 
$j$ë²ˆì§¸ ì—´ì„ ì˜ë¯¸í•œë‹¤.
### **ì˜ˆì œìž…ì¶œë ¥**

**ì˜ˆì œ ìž…ë ¥1**

```
4 5
1 18 2 3 4
12 17 15 20 5
11 14 19 13 6
10 9 16 8 7
6
```

**ì˜ˆì œ ì¶œë ¥1**

```
1 2
2 2
4 3
3 3
2 3
2 4
```

**ì˜ˆì œ ìž…ë ¥2**

```
3 3
9 8 1
4 5 2
6 3 7
4
```

**ì˜ˆì œ ì¶œë ¥2**

```
1 1
1 2
3 3
3 1
```
### **ì¶œì²˜**

## **ðŸ§CODE REVIEW**

### **ðŸ§¾ë‚˜ì˜ í’€ì´**

```python
from heapq import heappop, heappush

N, M = map(int, input().split())
table = [list(map(int, input().split())) for _ in range(N)]
K = int(input())

pq = []
dx = [1, 0, -1, 0]
dy = [0, 1, 0, -1]

visited = [[False] * M for _ in range(N)]

for j in range(M):
    heappush(pq, (-table[0][j], 0, j))
    visited[0][j] = True
    if N > 1:
        heappush(pq, (-table[N-1][j], N-1, j))
        visited[N-1][j] = True

for i in range(1, N-1):
    heappush(pq, (-table[i][0], i, 0))
    visited[i][0] = True
    if M > 1:
        heappush(pq, (-table[i][M-1], i, M-1))
        visited[i][M-1] = True

count = 0
while count < K:
    value, x, y = heappop(pq)
    print(x+1, y+1)
    count += 1

    for i in range(4):
        nx, ny = x + dx[i], y + dy[i]

        if 0 <= nx < N and 0 <= ny < M and not visited[nx][ny]:
            heappush(pq, (-table[nx][ny], nx, ny))
            visited[nx][ny] = True
```

ê²°ê³¼	| ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B)
:----:|:-----:|:-----:|:-----:|:--------:
ì •ë‹µ|146460|668|PyPy3|899
#### **ðŸ“í•´ì„¤**

**ì•Œê³ ë¦¬ì¦˜**
```
1. ìš°ì„ ìˆœìœ„ í
2. BFS
```

#### **ðŸ“í•´ì„¤**

```python
from heapq import heappop, heappush

N, M = map(int, input().split())
table = [list(map(int, input().split())) for _ in range(N)]
K = int(input())

# ìµœëŒ€íž™ì„ ì‚¬ìš©í•´ì„œ í° ìˆ«ìžê°€ ë¨¼ì € ë‚˜ì˜¤ê²Œë” í•¨
pq = []

# ìƒí•˜ì¢Œìš° ì´ë™ì„ ìœ„í•œ ë¦¬ìŠ¤íŠ¸
dx = [1, 0, -1, 0]
dy = [0, 1, 0, -1]

# ë°©ë¬¸ ì—¬ë¶€ë¥¼ ì €ìž¥í•  ë¦¬ìŠ¤íŠ¸
visited = [[False] * M for _ in range(N)]

# ìƒí•˜ì¢Œìš° í…Œë‘ë¦¬ë¥¼ ìš°ì„ ìˆœìœ„íì— ì‚½ìž…
for j in range(M):
    heappush(pq, (-table[0][j], 0, j))
    visited[0][j] = True
    if N > 1:
        heappush(pq, (-table[N-1][j], N-1, j))
        visited[N-1][j] = True

for i in range(1, N-1):
    heappush(pq, (-table[i][0], i, 0))
    visited[i][0] = True
    if M > 1:
        heappush(pq, (-table[i][M-1], i, M-1))
        visited[i][M-1] = True

# Kë²ˆ ë°˜ë³µ
count = 0
while count < K:
    value, x, y = heappop(pq)
    print(x+1, y+1)
    count += 1

    for i in range(4):
        nx, ny = x + dx[i], y + dy[i]

        if 0 <= nx < N and 0 <= ny < M and not visited[nx][ny]:
            heappush(pq, (-table[nx][ny], nx, ny))
            visited[nx][ny] = True
```