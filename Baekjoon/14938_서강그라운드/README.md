# [14938] ì„œê°•ê·¸ë¼ìš´ë“œ

### **ë‚œì´ë„**
ê³¨ë“œ 4
## **ðŸ“ë¬¸ì œ**
ì˜ˆì€ì´ëŠ” ìš”ì¦˜ ê°€ìž¥ ì¸ê¸°ê°€ ìžˆëŠ” ê²Œìž„ ì„œê°•ê·¸ë¼ìš´ë“œë¥¼ ì¦ê¸°ê³  ìžˆë‹¤. ì„œê°•ê·¸ë¼ìš´ë“œëŠ” ì—¬ëŸ¬ ì§€ì—­ì¤‘ í•˜ë‚˜ì˜ ì§€ì—­ì— ë‚™í•˜ì‚°ì„ íƒ€ê³  ë‚™í•˜í•˜ì—¬, ê·¸ ì§€ì—­ì— ë–¨ì–´ì ¸ ìžˆëŠ” ì•„ì´í…œë“¤ì„ ì´ìš©í•´ ì„œë°”ì´ë²Œì„ í•˜ëŠ” ê²Œìž„ì´ë‹¤. ì„œê°•ê·¸ë¼ìš´ë“œì—ì„œ 1ë“±ì„ í•˜ë©´ ë³´ìƒìœ¼ë¡œ ì¹˜í‚¨ì„ ì£¼ëŠ”ë°, ì˜ˆì€ì´ëŠ” ë‹¨ í•œë²ˆë„ ì¹˜í‚¨ì„ ë¨¹ì„ ìˆ˜ê°€ ì—†ì—ˆë‹¤. ìžì‹ ì´ ì¹˜í‚¨ì„ ëª» ë¨¹ëŠ” ì´ìœ ëŠ” ì‹¤ë ¥ ë•Œë¬¸ì´ ì•„ë‹ˆë¼ ì•„ì´í…œ ìš´ì´ ì—†ì–´ì„œë¼ê³  ìƒê°í•œ ì˜ˆì€ì´ëŠ” ë‚™í•˜ì‚°ì—ì„œ ë–¨ì–´ì§ˆ ë•Œ ê° ì§€ì—­ì— ì•„ì´í…œ ë“¤ì´ ëª‡ ê°œ ìžˆëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” í”„ë¡œê·¸ëž¨ì„ ê°œë°œì„ í•˜ì˜€ì§€ë§Œ ì–´ë””ë¡œ ë‚™í•˜í•´ì•¼ ìžì‹ ì˜ ìˆ˜ìƒ‰ ë²”ìœ„ ë‚´ì—ì„œ ê°€ìž¥ ë§Žì€ ì•„ì´í…œì„ ì–»ì„ ìˆ˜ ìžˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ì—ˆë‹¤.

ê° ì§€ì—­ì€ ì¼ì •í•œ ê¸¸ì´ l (1 â‰¤ l â‰¤ 15)ì˜ ê¸¸ë¡œ ë‹¤ë¥¸ ì§€ì—­ê³¼ ì—°ê²°ë˜ì–´ ìžˆê³  ì´ ê¸¸ì€ ì–‘ë°©í–¥ í†µí–‰ì´ ê°€ëŠ¥í•˜ë‹¤. ì˜ˆì€ì´ëŠ” ë‚™í•˜í•œ ì§€ì—­ì„ ì¤‘ì‹¬ìœ¼ë¡œ ê±°ë¦¬ê°€ ìˆ˜ìƒ‰ ë²”ìœ„ m (1 â‰¤ m â‰¤ 15) ì´ë‚´ì˜ ëª¨ë“  ì§€ì—­ì˜ ì•„ì´í…œì„ ìŠµë“ ê°€ëŠ¥í•˜ë‹¤ê³  í•  ë•Œ, ì˜ˆì€ì´ê°€ ì–»ì„ ìˆ˜ ìžˆëŠ” ì•„ì´í…œì˜ ìµœëŒ€ ê°œìˆ˜ë¥¼ ì•Œë ¤ì£¼ìž.

[ì´ë¯¸ì§€](https://upload.acmicpc.net/ef3a5124-833a-42ef-a092-fd658bc8e662/-/preview/)

ì£¼ì–´ì§„ í•„ë“œê°€ ìœ„ì˜ ê·¸ë¦¼ê³¼ ê°™ê³ , ì˜ˆì€ì´ì˜ ìˆ˜ìƒ‰ë²”ìœ„ê°€ 4ë¼ê³  í•˜ìž. ( ì› ë°–ì˜ ìˆ«ìžëŠ” ì§€ì—­ ë²ˆí˜¸, ì•ˆì˜ ìˆ«ìžëŠ” ì•„ì´í…œ ìˆ˜, ì„  ìœ„ì˜ ìˆ«ìžëŠ” ê±°ë¦¬ë¥¼ ì˜ë¯¸í•œë‹¤) ì˜ˆì€ì´ê°€ 2ë²ˆ ì§€ì—­ì— ë–¨ì–´ì§€ê²Œ ë˜ë©´ 1ë²ˆ,2ë²ˆ(ìžê¸° ì§€ì—­), 3ë²ˆ, 5ë²ˆ ì§€ì—­ì— ë„ë‹¬í•  ìˆ˜ ìžˆë‹¤. (4ë²ˆ ì§€ì—­ì˜ ê²½ìš° ê°€ëŠ” ê±°ë¦¬ê°€ 3 + 5 = 8 > 4(ìˆ˜ìƒ‰ë²”ìœ„) ì´ë¯€ë¡œ 4ë²ˆ ì§€ì—­ì˜ ì•„ì´í…œì„ ì–»ì„ ìˆ˜ ì—†ë‹¤.) ì´ë ‡ê²Œ ë˜ë©´ ì˜ˆì€ì´ëŠ” 23ê°œì˜ ì•„ì´í…œì„ ì–»ì„ ìˆ˜ ìžˆê³ , ì´ëŠ” ìœ„ì˜ í•„ë“œì—ì„œ ì˜ˆì€ì´ê°€ ì–»ì„ ìˆ˜ ìžˆëŠ” ì•„ì´í…œì˜ ìµœëŒ€ ê°œìˆ˜ì´ë‹¤.
### **ìž…ë ¥**
ì²«ì§¸ ì¤„ì—ëŠ” ì§€ì—­ì˜ ê°œìˆ˜ n (1 â‰¤ n â‰¤ 100)ê³¼ ì˜ˆì€ì´ì˜ ìˆ˜ìƒ‰ë²”ìœ„ m (1 â‰¤ m â‰¤ 15), ê¸¸ì˜ ê°œìˆ˜ r (1 â‰¤ r â‰¤ 100)ì´ ì£¼ì–´ì§„ë‹¤.

ë‘˜ì§¸ ì¤„ì—ëŠ” nê°œì˜ ìˆ«ìžê°€ ì°¨ë¡€ëŒ€ë¡œ ê° êµ¬ì—­ì— ìžˆëŠ” ì•„ì´í…œì˜ ìˆ˜ t (1 â‰¤ t â‰¤ 30)ë¥¼ ì•Œë ¤ì¤€ë‹¤.

ì„¸ ë²ˆì§¸ ì¤„ë¶€í„° r+2ë²ˆì§¸ ì¤„ ê¹Œì§€ ê¸¸ ì–‘ ëì— ì¡´ìž¬í•˜ëŠ” ì§€ì—­ì˜ ë²ˆí˜¸ a, b, ê·¸ë¦¬ê³  ê¸¸ì˜ ê¸¸ì´ l (1 â‰¤ l â‰¤ 15)ê°€ ì£¼ì–´ì§„ë‹¤.

ì§€ì—­ì˜ ë²ˆí˜¸ëŠ” 1ì´ìƒ nì´í•˜ì˜ ì •ìˆ˜ì´ë‹¤. ë‘ ì§€ì—­ì˜ ë²ˆí˜¸ê°€ ê°™ì€ ê²½ìš°ëŠ” ì—†ë‹¤.
### **ì¶œë ¥**
ì˜ˆì€ì´ê°€ ì–»ì„ ìˆ˜ ìžˆëŠ” ìµœëŒ€ ì•„ì´í…œ ê°œìˆ˜ë¥¼ ì¶œë ¥í•œë‹¤.
### **ì˜ˆì œìž…ì¶œë ¥**

**ì˜ˆì œ ìž…ë ¥1**

```
5 5 4
5 7 8 2 3
1 4 5
5 2 4
3 2 3
1 2 3
```

**ì˜ˆì œ ì¶œë ¥1**

```
23
```

### **ì¶œì²˜**

## **ðŸ§CODE REVIEW**

### **ðŸ§¾ë‚˜ì˜ í’€ì´**

```python
import sys
from heapq import heappush, heappop

N, M, R = map(int, sys.stdin.readline().rstrip().split())
items = [0] + list(map(int, sys.stdin.readline().rstrip().split()))

edges = [[] for _ in range(N+1)]
for _ in range(R):
    a, b, l = map(int, sys.stdin.readline().rstrip().split())
    edges[a].append((l, b))
    edges[b].append((l, a))

max_item = 0
for i in range(1, N+1):
    dist = [int(21e8)] * (N+1)
    dist[i] = 0

    pq = [(0, i)]

    while pq:
        now_dist, now_node = heappop(pq)

        if now_dist > dist[now_node]:
            continue

        for next_dist, next_node in edges[now_node]:
            new_dist = next_dist + now_dist

            if new_dist < dist[next_node]:
                heappush(pq, (new_dist, next_node))
                dist[next_node] = new_dist

    temp_item = 0
    for i in range(1, N+1):
        if dist[i] <= M:
            temp_item += items[i]

    max_item = max(max_item, temp_item)

print(max_item)
```

ê²°ê³¼	| ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B)
:----:|:-----:|:-----:|:-----:|:--------:
ì •ë‹µ|112020|152|PyPy3|965
#### **ðŸ“í•´ì„¤**

**ì•Œê³ ë¦¬ì¦˜**
```
1. ë‹¤ìµìŠ¤íŠ¸ë¼
```

### **ë‹¤ë¥¸ í’€ì´**

```python
def dfs(s):
    global ans
    stack = []
    stack.append([0,s])
    v_cost_lst = [float('inf')] * (N + 1)
    v_lst = [0] * (N + 1)
    v_cost_lst[s] = 0
    v_lst[s] = 1
    while stack:
        c_cost, c_position = stack.pop()
        if v_cost_lst[c_position] < c_cost:
            continue
        for cost, n_position in edge_lst[c_position]:
            n_cost = cost + c_cost
            if n_cost <= M and v_cost_lst[n_position] > n_cost:
                v_cost_lst[n_position] = n_cost
                v_lst[n_position] = 1
                stack.append([n_cost, n_position])
    cnt = 0
    for i in range(1,1+N):
        if v_lst[i]:
            cnt += item_lst[i]
    ans = max(cnt, ans)
    return


N, M, R = map(int,input().split())
item_lst = [0] + list(map(int,input().split()))
edge_lst = [[]for _ in range(N+1)]
for _ in range(R):
    p, c, f_cost = map(int,input().split())
    edge_lst[p].append([f_cost,c])
    edge_lst[c].append([f_cost,p])
ans = 0
for i in range(1,1+N):
    dfs(i)
print(ans)
```

ì•„ì´ë”” | ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B) 
:-----:|:-----:|:-----:|:----:|:--------:
wasdl|31120|32|Python3|1017
#### **ðŸ“í•´ì„¤**

```python
import sys
from heapq import heappush, heappop

N, M, R = map(int, sys.stdin.readline().rstrip().split())
items = [0] + list(map(int, sys.stdin.readline().rstrip().split()))

# ê°„ì„  ì •ë³´ë¥¼ ì €ìž¥í•  ë¦¬ìŠ¤íŠ¸
edges = [[] for _ in range(N+1)]

# ê°„ì„  ì •ë³´ ìž…ë ¥
for _ in range(R):
    a, b, l = map(int, sys.stdin.readline().rstrip().split())
    edges[a].append((l, b))
    edges[b].append((l, a))

# ìµœëŒ€ë¡œ íšë“í•  ìˆ˜ ìžˆëŠ” ì•„ì´í…œ ê°œìˆ˜
max_item = 0

# ëª¨ë“  ë…¸ë“œì—ì„œ ë¶€í„° ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©
for i in range(1, N+1):

    # ê°„ì„ ê¹Œì§€ ê±°ë¦¬
    dist = [int(21e8)] * (N+1)

    # ì‹œìž‘ì ì€ 0ìœ¼ë¡œ ì´ˆê¸°í™”
    dist[i] = 0
    
    # ë‹¤ìµìŠ¤íŠ¸ë¼ ì‚¬ìš©ì„ ìœ„í•œ ìš°ì„ ìˆœìœ„ í (ê°„ì„  ê±°ë¦¬, í˜„ìž¬ ë…¸ë“œ)
    pq = [(0, i)]

    # ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜
    while pq:
        now_dist, now_node = heappop(pq)

        if now_dist > dist[now_node]:
            continue

        for next_dist, next_node in edges[now_node]:
            new_dist = next_dist + now_dist

            if new_dist < dist[next_node]:
                heappush(pq, (new_dist, next_node))
                dist[next_node] = new_dist

    # ì´ë²ˆ ë…¸ë“œì—ì„œ íšë“í•  ìˆ˜ ìžˆëŠ” ì•„ì´í…œ ê°œìˆ˜
    temp_item = 0
    for i in range(1, N+1):
        if dist[i] <= M:
            temp_item += items[i]

    max_item = max(max_item, temp_item)

print(max_item)
```