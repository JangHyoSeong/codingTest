# [17281] βΎ

### **λ‚μ΄λ„**
κ³¨λ“ 4
## **π“λ¬Έμ **
βΎλ” 9λ…μΌλ΅ μ΄λ£¨μ–΄μ§„ λ‘ ν€μ΄ κ³µκ²©κ³Ό μλΉ„λ¥Ό λ²κ°μ•„ ν•λ” κ²μ„μ΄λ‹¤. ν•λ‚μ μ΄λ‹μ€ κ³µκ²©κ³Ό μλΉ„λ΅ μ΄λ£¨μ–΄μ Έ μκ³ , μ΄ Nμ΄λ‹ λ™μ• κ²μ„μ„ μ§„ν–‰ν•΄μ•Ό ν•λ‹¤. ν• μ΄λ‹μ— 3μ•„μ›ƒμ΄ λ°μƒν•λ©΄ μ΄λ‹μ΄ μΆ…λ£λκ³ , λ‘ ν€μ΄ κ³µκ²©κ³Ό μλΉ„λ¥Ό μ„λ΅ λ°”κΎΌλ‹¤.

λ‘ ν€μ€ κ²½κΈ°κ°€ μ‹μ‘ν•κΈ° μ „κΉμ§€ νƒ€μ(νƒ€μκ°€ νƒ€μ„μ— μ„λ” μμ„)μ„ μ •ν•΄μ•Ό ν•κ³ , κ²½κΈ° μ¤‘μ—λ” νƒ€μμ„ λ³€κ²½ν•  μ μ—†λ‹¤. 9λ² νƒ€μκΉμ§€ κ³µμ„ μ³¤λ”λ° 3μ•„μ›ƒμ΄ λ°μƒν•μ§€ μ•μ€ μƒνƒλ©΄ μ΄λ‹μ€ λλ‚μ§€ μ•κ³ , 1λ² νƒ€μκ°€ λ‹¤μ‹ νƒ€μ„μ— μ„ λ‹¤. νƒ€μμ€ μ΄λ‹μ΄ λ³€κ²½λμ–΄λ„ μμ„λ¥Ό μ μ§€ν•΄μ•Ό ν•λ‹¤. μλ¥Ό λ“¤μ–΄, 2μ΄λ‹μ— 6λ² νƒ€μκ°€ λ§μ§€λ§‰ νƒ€μμ€λ‹¤λ©΄, 3μ΄λ‹μ€ 7λ² νƒ€μλ¶€ν„° νƒ€μ„μ— μ„ λ‹¤.

κ³µκ²©μ€ ν¬μκ°€ λμ§„ κ³µμ„ νƒ€μ„μ— μλ” νƒ€μκ°€ μΉλ” κ²ƒμ΄λ‹¤. κ³µκ²© ν€μ μ„ μκ°€ 1λ£¨, 2λ£¨, 3λ£¨λ¥Ό κ±°μ³μ„ ν™μ— λ„μ°©ν•λ©΄ 1μ μ„ λ“μ ν•λ‹¤. νƒ€μκ°€ ν™μ— λ„μ°©ν•μ§€ λ»ν•κ³  1λ£¨, 2λ£¨, 3λ£¨ μ¤‘ ν•λ‚μ— λ¨Έλ¬Όλ¬μμ„ μ μλ‹¤. λ£¨μ— μλ” μ„ μλ¥Ό μ£ΌμλΌκ³  ν•λ‹¤. μ΄λ‹μ΄ μ‹μ‘λ  λ•λ” μ£Όμλ” μ—†λ‹¤.

νƒ€μκ°€ κ³µμ„ μ³μ„ μ–»μ„ μ μλ” κ²°κ³Όλ” μ•νƒ€, 2λ£¨νƒ€, 3λ£¨νƒ€, ν™λ°, μ•„μ›ƒ μ¤‘ ν•λ‚μ΄λ‹¤. κ°κ°μ΄ λ°μƒν–μ„ λ•, λ²μ–΄μ§€λ” μΌμ€ λ‹¤μκ³Ό κ°™λ‹¤.

- μ•νƒ€: νƒ€μμ™€ λ¨λ“  μ£Όμκ°€ ν• λ£¨μ”© μ§„λ£¨ν•λ‹¤.
- 2λ£¨νƒ€: νƒ€μμ™€ λ¨λ“  μ£Όμκ°€ λ‘ λ£¨μ”© μ§„λ£¨ν•λ‹¤.
- 3λ£¨νƒ€: νƒ€μμ™€ λ¨λ“  μ£Όμκ°€ μ„Έ λ£¨μ”© μ§„λ£¨ν•λ‹¤.
- ν™λ°: νƒ€μμ™€ λ¨λ“  μ£Όμκ°€ ν™κΉμ§€ μ§„λ£¨ν•λ‹¤.
- μ•„μ›ƒ: λ¨λ“  μ£Όμλ” μ§„λ£¨ν•μ§€ λ»ν•κ³ , κ³µκ²© ν€μ— μ•„μ›ƒμ΄ ν•λ‚ μ¦κ°€ν•λ‹¤.  
ν• μ•Όκµ¬ν€μ κ°λ… μ•„μΈνƒ€λ” νƒ€μμ„ μ •ν•λ ¤κ³  ν•λ‹¤. μ•„μΈνƒ€ ν€μ μ„ μλ” μ΄ 9λ…μ΄ μκ³ , 1λ²λ¶€ν„° 9λ²κΉμ§€ λ²νΈκ°€ λ§¤κ²¨μ Έ μλ‹¤. μ•„μΈνƒ€λ” μμ‹ μ΄ κ°€μ¥ μΆ‹μ•„ν•λ” μ„ μμΈ 1λ² μ„ μλ¥Ό 4λ² νƒ€μλ΅ λ―Έλ¦¬ κ²°μ •ν–λ‹¤. μ΄μ  λ‹¤λ¥Έ μ„ μμ νƒ€μμ„ λ¨λ‘ κ²°μ •ν•΄μ•Ό ν•λ‹¤. μ•„μΈνƒ€λ” κ° μ„ μκ°€ κ° μ΄λ‹μ—μ„ μ–΄λ–¤ κ²°κ³Όλ¥Ό μ–»λ”μ§€ λ―Έλ¦¬ μ•κ³  μλ‹¤. κ°€μ¥ λ§μ€ λ“μ μ„ ν•λ” νƒ€μμ„ μ°Ύκ³ , κ·Έ λ•μ λ“μ μ„ κµ¬ν•΄λ³΄μ.
### **μ…λ ¥**
μ²«μ§Έ μ¤„μ— μ΄λ‹ μ N(2 β‰¤ N β‰¤ 50)μ΄ μ£Όμ–΄μ§„λ‹¤. λ‘μ§Έ μ¤„λ¶€ν„° Nκ°μ μ¤„μ—λ” κ° μ„ μκ°€ κ° μ΄λ‹μ—μ„ μ–»λ” κ²°κ³Όκ°€ 1λ² μ΄λ‹λ¶€ν„° Nλ² μ΄λ‹κΉμ§€ μμ„λ€λ΅ μ£Όμ–΄μ§„λ‹¤. μ΄λ‹μ—μ„ μ–»λ” κ²°κ³Όλ” 9κ°μ μ •μκ°€ κ³µλ°±μΌλ΅ κµ¬λ¶„λμ–΄μ Έ μλ‹¤. κ° κ²°κ³Όκ°€ μλ―Έν•λ” μ •μλ” λ‹¤μκ³Ό κ°™λ‹¤.

- μ•νƒ€: 1
- 2λ£¨νƒ€: 2
- 3λ£¨νƒ€: 3
- ν™λ°: 4
- μ•„μ›ƒ: 0  
κ° μ΄λ‹μ—λ” μ•„μ›ƒμ„ κΈ°λ΅ν•λ” νƒ€μκ°€ μ μ–΄λ„ ν• λ… μ΅΄μ¬ν•λ‹¤.
### **μ¶λ ¥**
μ•„μΈνƒ€ν€μ΄ μ–»μ„ μ μλ” μµλ€ μ μλ¥Ό μ¶λ ¥ν•λ‹¤.
### **μμ μ…μ¶λ ¥**

**μμ  μ…λ ¥1**

```
2
4 0 0 0 0 0 0 0 0
4 0 0 0 0 0 0 0 0
```

**μμ  μ¶λ ¥1**

```
1
```

**μμ  μ…λ ¥2**

```
2
4 0 0 0 1 1 1 0 0
0 0 0 0 0 0 0 0 0
```

**μμ  μ¶λ ¥2**

```
4
```

**μμ  μ…λ ¥3**

```
2
0 4 4 4 4 4 4 4 4
0 4 4 4 4 4 4 4 4
```

**μμ  μ¶λ ¥3**

```
43
```

### **μ¶μ²**

## **π§CODE REVIEW**

### **π§Ύλ‚μ ν’€μ΄**

```python
from itertools import permutations

N = int(input())
innings = [list(map(int, input().split())) for _ in range(N)]

max_score = 0

others = [i for i in range(1, 9)]

for order in permutations(others):
    batting_order = list(order[:3]) + [0] + list(order[3:])
    score = 0
    batter_idx = 0

    for inning in innings:
        out_count = 0
        base = [0, 0, 0]

        while out_count < 3:
            player = batting_order[batter_idx]
            result = inning[player]

            if result == 0:
                out_count += 1
            elif result == 1:
                score += base[2]
                base = [1] + base[:2]
            elif result == 2:
                score += base[2] + base[1]
                base = [0, 1, base[0]]
            elif result == 3:
                score += base[2] + base[1] + base[0]
                base = [0, 0, 1]
            elif result == 4:
                score += base[0] + base[1] + base[2] + 1
                base = [0, 0, 0]

            batter_idx = (batter_idx + 1) % 9

    max_score = max(max_score, score)

print(max_score)
```

κ²°κ³Ό	| λ©”λ¨λ¦¬(KB) |	μ‹κ°„(ms) |	μ–Έμ–΄ |	μ½”λ“ κΈΈμ΄(B)
:----:|:-----:|:-----:|:-----:|:--------:
μ •λ‹µ|110964|956|PyPy3|1094
#### **π“ν•΄μ„¤**

**μ•κ³ λ¦¬μ¦**
```
1. κµ¬ν„
```

### **λ‹¤λ¥Έ ν’€μ΄**

```python
#ref: https://www.acmicpc.net/source/57009296 -> μ†λ„ λΉ¨λΌμ§€λ”μ§€ ν™•μΈ

from itertools import permutations
num = int(input())
rounds = []
for _ in range(num):
    rounds.append(list(map(int, input().split())))

max_inning_score = [0]*num
for inning, h in enumerate(rounds):
    h_sorted = list(sorted(h))

    zeros = 0
    while zeros < 9 and h_sorted[0] == 0:
        h_sorted.append(h_sorted.pop(0))
        zeros += 1

    score = 0
    hitter = 0
    first, second, third = 0, 0, 0
    out = 0
    while out < 3:
        step = h_sorted[hitter]
        if step == 0:
            out += 1
        elif step == 1:
            score += first
            first, second, third = second, third, 1
        elif step == 2:
            score += first + second
            first, second, third = third, 1, 0
        elif step == 3:
            score += first + second + third
            first, second, third = 1, 0, 0
        else:
            score += first + second + third + 1
            first, second, third = 0, 0, 0
        hitter = (hitter + 1) % 9
    max_inning_score[inning] = score

#get max score possible for the remaining innings
max_score_possible = [0]*num
max_score_accumulated = 0
for i in range(num-1, -1, -1):
    max_score_accumulated += max_inning_score[i]
    max_score_possible[i] = max_score_accumulated


max = 0
for p in permutations(range(1, 9)):
    p = list(p)
    global order
    order = p[:3] + [0] + p[3:]
    score = 0
    hitter = 0
    for inning, round in enumerate(rounds):
        if score + max_score_possible[inning] <= max:
            break
        first, second, third = 0, 0, 0
        out = 0
        while out < 3:
            step = round[order[hitter]]
            if step == 0:
                out += 1
            elif step == 1:
                score += first
                first, second, third = second, third, 1
            elif step == 2:
                score += first + second
                first, second, third = third, 1, 0
            elif step == 3:
                score += first + second + third
                first, second, third = 1, 0, 0
            else:
                score += first + second + third + 1
                first, second, third = 0, 0, 0
            hitter = (hitter + 1) % 9
    if score > max:
        max = score
print(max)
```

μ•„μ΄λ”” | λ©”λ¨λ¦¬(KB) |	μ‹κ°„(ms) |	μ–Έμ–΄ |	μ½”λ“ κΈΈμ΄(B) 
:-----:|:-----:|:-----:|:----:|:--------:
heoragi53|115356|552|PyPy3|2321
#### **π“ν•΄μ„¤**

```python
from itertools import permutations

# μ…λ ¥λ°›κΈ°
N = int(input())
innings = [list(map(int, input().split())) for _ in range(N)]

# μµλ€μ μ
max_score = 0

# 1λ² νƒ€μ(0λ² μΈλ±μ¤)λ” 4λ² νƒ€μ„ κ³ μ •μ΄κ³ , λ‚λ¨Έμ§€μ μΈλ±μ¤
others = [i for i in range(1, 9)]

# κ°€λ¥ν• λ¨λ“  κ²½μ°λ¥Ό μμ—΄λ΅ μƒμ„±
for order in permutations(others):

    # 1λ² νƒ€μλ¥Ό 4λ² νƒ€μ„μ— ν¬ν•¨
    batting_order = list(order[:3]) + [0] + list(order[3:])

    # μ΄λ² μ΅°ν•©μ—μ„μ μ μ
    score = 0

    # νƒ€μ„μ— μ„¤ νƒ€μμ μΈλ±μ¤
    batter_idx = 0

    # μ΄λ‹λ“¤μ„ λ¨λ‘ κ²€μ‚¬
    for inning in innings:

        # μ•„μ›ƒ κ°―μ
        out_count = 0

        # λ² μ΄μ¤ μƒνƒ
        base = [0, 0, 0]

        # μ•„μ›ƒμ΄ 3λ² λκΈ° μ „κΉμ§€ ν„μ¬ μ΄λ‹μ„ μν–‰
        while out_count < 3:

            # ν„μ¬ νƒ€μμ μΈλ±μ¤
            player = batting_order[batter_idx]

            # νƒ€μκ°€ μ΄λ² μ΄λ‹μ—μ„ μΉ  κ²°κ³Ό
            result = inning[player]

            # μ•„μ›ƒ
            if result == 0:
                out_count += 1

            # 1λ£¨νƒ€
            elif result == 1:
                score += base[2]
                base = [1] + base[:2]
            
            # 2λ£¨νƒ€
            elif result == 2:
                score += base[2] + base[1]
                base = [0, 1, base[0]]

            # 3λ£¨νƒ€
            elif result == 3:
                score += base[2] + base[1] + base[0]
                base = [0, 0, 1]
            
            # 4λ£¨νƒ€
            elif result == 4:
                score += base[0] + base[1] + base[2] + 1
                base = [0, 0, 0]

            # λ‹¤μ νƒ€μλ΅ λ„μ–΄κ°
            batter_idx = (batter_idx + 1) % 9
    # μµλ€ μ μ κ°±μ‹ 
    max_score = max(max_score, score)

print(max_score)
```