# [14621] ë‚˜ë§Œ ì•ˆë˜ëŠ” ì—°ì• 

### **ë‚œì´ë„**
ê³¨ë“œ 3
## **ðŸ“ë¬¸ì œ**
ê¹½ë¯¸ëŠ” 24ì‚´ ëª¨íƒœì†”ë¡œì´ë‹¤. ê¹½ë¯¸ëŠ” ëŒ€ë§ˆë²•ì‚¬ê°€ ë  ìˆœ ì—†ë‹¤ë©° ìžì‹ ì˜ í”„ë¡œê·¸ëž˜ë° ëŠ¥ë ¥ì„ ì´ìš©í•˜ì—¬ ë¯¸íŒ… ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ê¸°ë¡œ ê²°ì‹¬í–ˆë‹¤. ë¯¸íŒ… ì•±ì€ ëŒ€í•™ìƒì„ íƒ€ê²Ÿìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œìœ¼ë©° ëŒ€í•™êµê°„ì˜ ë„ë¡œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì—¬ ë§Œë“¤ì—ˆë‹¤.

ì´ ì•±ì€ ì‚¬ìš©ìžë“¤ì„ ìœ„í•´ ì‚¬ì‹¬ ê²½ë¡œë¥¼ ì œê³µí•œë‹¤. ì´ ê²½ë¡œëŠ” 3ê°€ì§€ íŠ¹ì§•ì„ ê°€ì§€ê³  ìžˆë‹¤.

1. ì‚¬ì‹¬ ê²½ë¡œëŠ” ì‚¬ìš©ìžë“¤ì˜ ì‚¬ì‹¬ì„ ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•´ ë‚¨ì´ˆ ëŒ€í•™êµì™€ ì—¬ì´ˆ ëŒ€í•™êµë“¤ì„ ì—°ê²°í•˜ëŠ” ë„ë¡œë¡œë§Œ ì´ë£¨ì–´ì ¸ ìžˆë‹¤.
2. ì‚¬ìš©ìžë“¤ì´ ë‹¤ì–‘í•œ ì‚¬ëžŒê³¼ ë¯¸íŒ…í•  ìˆ˜ ìžˆë„ë¡ ì–´ë–¤ ëŒ€í•™êµì—ì„œë“  ëª¨ë“  ëŒ€í•™êµë¡œ ì´ë™ì´ ê°€ëŠ¥í•œ ê²½ë¡œì´ë‹¤.
ì‹œê°„ì„ ë‚­ë¹„í•˜ì§€ ì•Šê³  ë¯¸íŒ…í•  ìˆ˜ ìžˆë„ë¡ ì´ ê²½ë¡œì˜ ê¸¸ì´ëŠ” ìµœë‹¨ ê±°ë¦¬ê°€ ë˜ì–´ì•¼ í•œë‹¤.
3. ë§Œì•½ ë„ë¡œ ë°ì´í„°ê°€ ë§Œì•½ ì™¼ìª½ì˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤ë©´, ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì˜ ë³´ë¼ìƒ‰ ì„ ê³¼ ê°™ì´ ê²½ë¡œë¥¼ êµ¬ì„±í•˜ë©´ ìœ„ì˜ 3ê°€ì§€ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²½ë¡œë¥¼ ë§Œë“¤ ìˆ˜ ìžˆë‹¤.

ì´ë•Œ, ì£¼ì–´ì§€ëŠ” ê±°ë¦¬ ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ì‚¬ì‹¬ ê²½ë¡œì˜ ê¸¸ì´ë¥¼ êµ¬í•´ë³´ìž.
### **ìž…ë ¥**
ìž…ë ¥ì˜ ì²«ì§¸ ì¤„ì— í•™êµì˜ ìˆ˜ Nì™€ í•™êµë¥¼ ì—°ê²°í•˜ëŠ” ë„ë¡œì˜ ê°œìˆ˜ Mì´ ì£¼ì–´ì§„ë‹¤. (2 â‰¤ N â‰¤ 1,000) (1 â‰¤ M â‰¤ 10,000)

ë‘˜ì§¸ ì¤„ì— ê° í•™êµê°€ ë‚¨ì´ˆ ëŒ€í•™êµë¼ë©´ M, ì—¬ì´ˆ ëŒ€í•™êµë¼ë©´ Wì´ ì£¼ì–´ì§„ë‹¤.

ë‹¤ìŒ Mê°œì˜ ì¤„ì— u v dê°€ ì£¼ì–´ì§€ë©° uí•™êµì™€ ví•™êµê°€ ì—°ê²°ë˜ì–´ ìžˆìœ¼ë©° ì´ ê±°ë¦¬ëŠ” dìž„ì„ ë‚˜íƒ€ë‚¸ë‹¤. (1 â‰¤ u, v â‰¤ N) , (1 â‰¤ d â‰¤ 1,000)
### **ì¶œë ¥**
ê¹½ë¯¸ê°€ ë§Œë“  ì•±ì˜ ê²½ë¡œ ê¸¸ì´ë¥¼ ì¶œë ¥í•œë‹¤. (ëª¨ë“  í•™êµë¥¼ ì—°ê²°í•˜ëŠ” ê²½ë¡œê°€ ì—†ì„ ê²½ìš° -1ì„ ì¶œë ¥í•œë‹¤.)
### **ì˜ˆì œìž…ì¶œë ¥**

**ì˜ˆì œ ìž…ë ¥1**

```
5 7
M W W W M
1 2 12
1 3 10
4 2 5
5 2 5
2 5 10
3 4 3
5 4 7
```

**ì˜ˆì œ ì¶œë ¥1**

```
34
```
### **ì¶œì²˜**

## **ðŸ§CODE REVIEW**

### **ðŸ§¾ë‚˜ì˜ í’€ì´**

```python
# ìœ ë‹ˆì˜¨-íŒŒì¸ë“œ(Union-Find) í•¨ìˆ˜ ì •ì˜
def find(parent, x):
    if parent[x] != x:
        parent[x] = find(parent, parent[x])
    return parent[x]

def union(parent, rank, x, y):
    rootX = find(parent, x)
    rootY = find(parent, y)

    if rootX != rootY:
        if rank[rootX] > rank[rootY]:
            parent[rootY] = rootX
        elif rank[rootX] < rank[rootY]:
            parent[rootX] = rootY
        else:
            parent[rootY] = rootX
            rank[rootX] += 1

# ìž…ë ¥ ì²˜ë¦¬
N, M = map(int, input().split())
schools = ['0'] + input().split()  # í•™êµ ì •ë³´, ë‚¨ì´ˆ(M) ì—¬ì´ˆ(W)

edges = []
for _ in range(M):
    u, v, d = map(int, input().split())
    if schools[u] != schools[v]:  # ë‚¨ì´ˆ-ì—¬ì´ˆ í•™êµ ê°„ ì—°ê²°ë§Œ í—ˆìš©
        edges.append((d, u, v))

# í¬ë£¨ìŠ¤ì¹¼ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ìµœì†Œ ì‹ ìž¥ íŠ¸ë¦¬(MST) êµ¬ì„±
edges.sort()  # ê±°ë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
parent = [i for i in range(N + 1)]  # ìœ ë‹ˆì˜¨-íŒŒì¸ë“œìš© ë¶€ëª¨ ë°°ì—´
rank = [0] * (N + 1)

mst_weight = 0
edge_count = 0

for edge in edges:
    weight, u, v = edge
    if find(parent, u) != find(parent, v):  # ì‚¬ì´í´ì´ ìƒê¸°ì§€ ì•Šë„ë¡ ì²´í¬
        union(parent, rank, u, v)
        mst_weight += weight
        edge_count += 1
        if edge_count == N - 1:  # N-1ê°œì˜ ê°„ì„ ì„ ì„ íƒí•˜ë©´ MST ì™„ì„±
            break

# ê²°ê³¼ ì¶œë ¥
if edge_count == N - 1:
    print(mst_weight)
else:
    print(-1)
```

ê²°ê³¼	| ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B)
:----:|:-----:|:-----:|:-----:|:--------:
ì •ë‹µ|111588|132|PyPy3|1456
#### **ðŸ“í•´ì„¤**

**ì•Œê³ ë¦¬ì¦˜**
```
1. ìµœì†Œ ìŠ¤íŒ¨ë‹ íŠ¸ë¦¬
2. ìœ ë‹ˆì˜¨ íŒŒì¸ë“œ
3. í¬ë£¨ìŠ¤ì¹¼ ì•Œê³ ë¦¬ì¦˜
```
### **ë‹¤ë¥¸ í’€ì´**

```python
import sys

input = sys.stdin.readline

n, m = map(int, input().split())
mw = [1 if i == 'M' else 0 for i in input().split()]
g = [[] for _ in range(n)]
edges = []
for _ in range(m):
    u, v, d = map(int, input().split())
    if mw[u - 1] + mw[v - 1] == 1:
        edges.append((u - 1, v - 1, d))

edges.sort(key=lambda x: x[2])

par = [i for i in range(n)]


def find(a):
    if par[a] == a:
        return a
    p = find(par[a])
    par[a] = p
    return p


def merge(a, b):
    a, b = find(a), find(b)
    if a == b:
        return False
    par[b] = a
    return True


ans = 0
cnt = 0
for u, v, d in edges:
    if merge(u, v):
        ans += d
        cnt += 1

if cnt == n - 1:
    print(ans)
else:
    print(-1)
```

ì•„ì´ë”” | ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B) 
:-----:|:-----:|:-----:|:----:|:--------:
imjaegon|32140|44|Python3|721