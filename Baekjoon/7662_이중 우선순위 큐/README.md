# [7662] ì´ì¤‘ ìš°ì„ ìˆœìœ„ í

### **ë‚œì´ë„**
ê³¨ë“œ 4
## **ğŸ“ë¬¸ì œ**
ì´ì¤‘ ìš°ì„ ìˆœìœ„ í(dual priority queue)ëŠ” ì „í˜•ì ì¸ ìš°ì„ ìˆœìœ„ íì²˜ëŸ¼ ë°ì´í„°ë¥¼ ì‚½ì…, ì‚­ì œí•  ìˆ˜ ìˆëŠ” ìë£Œ êµ¬ì¡°ì´ë‹¤. ì „í˜•ì ì¸ íì™€ì˜ ì°¨ì´ì ì€ ë°ì´í„°ë¥¼ ì‚­ì œí•  ë•Œ ì—°ì‚°(operation) ëª…ë ¹ì— ë”°ë¼ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ë°ì´í„° ë˜ëŠ” ê°€ì¥ ë‚®ì€ ë°ì´í„° ì¤‘ í•˜ë‚˜ë¥¼ ì‚­ì œí•˜ëŠ” ì ì´ë‹¤. ì´ì¤‘ ìš°ì„ ìˆœìœ„ íë¥¼ ìœ„í•´ì„  ë‘ ê°€ì§€ ì—°ì‚°ì´ ì‚¬ìš©ë˜ëŠ”ë°, í•˜ë‚˜ëŠ” ë°ì´í„°ë¥¼ ì‚½ì…í•˜ëŠ” ì—°ì‚°ì´ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì´ë‹¤. ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì€ ë˜ ë‘ ê°€ì§€ë¡œ êµ¬ë¶„ë˜ëŠ”ë° í•˜ë‚˜ëŠ” ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ê²ƒì„ ì‚­ì œí•˜ê¸° ìœ„í•œ ê²ƒì´ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë‚®ì€ ê²ƒì„ ì‚­ì œí•˜ê¸° ìœ„í•œ ê²ƒì´ë‹¤.

ì •ìˆ˜ë§Œ ì €ì¥í•˜ëŠ” ì´ì¤‘ ìš°ì„ ìˆœìœ„ í Qê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì. Qì— ì €ì¥ëœ ê° ì •ìˆ˜ì˜ ê°’ ìì²´ë¥¼ ìš°ì„ ìˆœìœ„ë¼ê³  ê°„ì£¼í•˜ì.

Qì— ì ìš©ë  ì¼ë ¨ì˜ ì—°ì‚°ì´ ì£¼ì–´ì§ˆ ë•Œ ì´ë¥¼ ì²˜ë¦¬í•œ í›„ ìµœì¢…ì ìœ¼ë¡œ Qì— ì €ì¥ëœ ë°ì´í„° ì¤‘ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì„ ì¶œë ¥í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ë¼.
### **ì…ë ¥**
ì…ë ¥ ë°ì´í„°ëŠ” í‘œì¤€ì…ë ¥ì„ ì‚¬ìš©í•œë‹¤. ì…ë ¥ì€ Tê°œì˜ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ êµ¬ì„±ëœë‹¤. ì…ë ¥ì˜ ì²« ë²ˆì§¸ ì¤„ì—ëŠ” ì…ë ¥ ë°ì´í„°ì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ Tê°€ ì£¼ì–´ì§„ë‹¤. ê° í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ì²«ì§¸ ì¤„ì—ëŠ” Qì— ì ìš©í•  ì—°ì‚°ì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ k (k â‰¤ 1,000,000)ê°€ ì£¼ì–´ì§„ë‹¤. ì´ì–´ì§€ëŠ” k ì¤„ ê°ê°ì—” ì—°ì‚°ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ì(â€˜Dâ€™ ë˜ëŠ” â€˜Iâ€™)ì™€ ì •ìˆ˜ nì´ ì£¼ì–´ì§„ë‹¤. â€˜I nâ€™ì€ ì •ìˆ˜ nì„ Qì— ì‚½ì…í•˜ëŠ” ì—°ì‚°ì„ ì˜ë¯¸í•œë‹¤. ë™ì¼í•œ ì •ìˆ˜ê°€ ì‚½ì…ë  ìˆ˜ ìˆìŒì„ ì°¸ê³ í•˜ê¸° ë°”ë€ë‹¤. â€˜D 1â€™ëŠ” Qì—ì„œ ìµœëŒ“ê°’ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì„ ì˜ë¯¸í•˜ë©°, â€˜D -1â€™ëŠ” Q ì—ì„œ ìµœì†Ÿê°’ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì„ ì˜ë¯¸í•œë‹¤. ìµœëŒ“ê°’(ìµœì†Ÿê°’)ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì—ì„œ ìµœëŒ“ê°’(ìµœì†Ÿê°’)ì´ ë‘˜ ì´ìƒì¸ ê²½ìš°, í•˜ë‚˜ë§Œ ì‚­ì œë¨ì„ ìœ ë…í•˜ê¸° ë°”ë€ë‹¤.

ë§Œì•½ Qê°€ ë¹„ì–´ìˆëŠ”ë° ì ìš©í•  ì—°ì‚°ì´ â€˜Dâ€™ë¼ë©´ ì´ ì—°ì‚°ì€ ë¬´ì‹œí•´ë„ ì¢‹ë‹¤. Qì— ì €ì¥ë  ëª¨ë“  ì •ìˆ˜ëŠ” -231 ì´ìƒ 231 ë¯¸ë§Œì¸ ì •ìˆ˜ì´ë‹¤.
### **ì¶œë ¥**
ì¶œë ¥ì€ í‘œì¤€ì¶œë ¥ì„ ì‚¬ìš©í•œë‹¤. ê° í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•´, ëª¨ë“  ì—°ì‚°ì„ ì²˜ë¦¬í•œ í›„ Qì— ë‚¨ì•„ ìˆëŠ” ê°’ ì¤‘ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì„ ì¶œë ¥í•˜ë¼. ë‘ ê°’ì€ í•œ ì¤„ì— ì¶œë ¥í•˜ë˜ í•˜ë‚˜ì˜ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ë¼. ë§Œì•½ Qê°€ ë¹„ì–´ìˆë‹¤ë©´ â€˜EMPTYâ€™ë¥¼ ì¶œë ¥í•˜ë¼.
### **ì˜ˆì œì…ì¶œë ¥**

**ì˜ˆì œ ì…ë ¥1**

```
2
7
I 16
I -5643
D -1
D 1
D 1
I 123
D -1
9
I -45
I 653
D 1
I -642
I 45
I 97
D 1
D -1
I 333
```

**ì˜ˆì œ ì¶œë ¥1**

```
EMPTY
333 -45
```

### **ì¶œì²˜**

## **ğŸ§CODE REVIEW**

### **ğŸ§¾ë‚˜ì˜ í’€ì´**

```python
import heapq

T = int(input())

for _ in range(T):
    k = int(input())
    
    min_heap = []
    max_heap = []
    visited = [False] * (k + 1)  # ì‚­ì œ ì—¬ë¶€ë¥¼ ì¶”ì í•˜ê¸° ìœ„í•œ ë°°ì—´

    for i in range(k):
        operation, num = input().split()
        num = int(num)
        
        if operation == 'I':
            # ì‚½ì… ì—°ì‚°
            heapq.heappush(min_heap, (num, i))  # ìµœì†Œ í™ì— ì‚½ì…
            heapq.heappush(max_heap, (-num, i))  # ìµœëŒ€ í™ì— ì‚½ì…
            visited[i] = True  # í•´ë‹¹ ì¸ë±ìŠ¤ëŠ” ì•„ì§ ì‚­ì œë˜ì§€ ì•ŠìŒ
            
        elif operation == 'D':
            if num == 1:  # ìµœëŒ“ê°’ ì‚­ì œ
                while max_heap and not visited[max_heap[0][1]]:
                    heapq.heappop(max_heap)  # ì´ë¯¸ ì‚­ì œëœ ê°’ì€ ë¬´ì‹œ
                if max_heap:
                    visited[max_heap[0][1]] = False  # ì‹¤ì œë¡œ ì‚­ì œ
                    heapq.heappop(max_heap)
            elif num == -1:  # ìµœì†Ÿê°’ ì‚­ì œ
                while min_heap and not visited[min_heap[0][1]]:
                    heapq.heappop(min_heap)  # ì´ë¯¸ ì‚­ì œëœ ê°’ì€ ë¬´ì‹œ
                if min_heap:
                    visited[min_heap[0][1]] = False  # ì‹¤ì œë¡œ ì‚­ì œ
                    heapq.heappop(min_heap)
    
    # ìµœì¢…ì ìœ¼ë¡œ ìœ íš¨í•œ ê°’ë§Œ ë‚¨ê¸°ê¸° ìœ„í•´ì„œ
    while max_heap and not visited[max_heap[0][1]]:
        heapq.heappop(max_heap)
    while min_heap and not visited[min_heap[0][1]]:
        heapq.heappop(min_heap)
    
    if not min_heap or not max_heap:
        print("EMPTY")
    else:
        print(-max_heap[0][0], min_heap[0][0])
```

ê²°ê³¼	| ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B)
:----:|:-----:|:-----:|:-----:|:--------:
ì •ë‹µ|354024|3712|PyPy3|1634
#### **ğŸ“í•´ì„¤**

**ì•Œê³ ë¦¬ì¦˜**
```
1. ìš°ì„ ìˆœìœ„ í
```

### **ë‹¤ë¥¸ í’€ì´**

```python
def main():
    import io, os, __pypy__
    from array import array
    from collections import defaultdict
    import heapq
    input = io.BytesIO(os.read(0, os.fstat(0).st_size)).readline
    output = __pypy__.builders.StringBuilder()
    T = int(input())
    for _ in range(T):
        k = int(input())
        maxq = array('i')
        minq = array('i')
        d = defaultdict(int)
        for _ in range(k):
            s = input()
            if s[0] == 68:
                if s[2] == 49:
                    while maxq:
                        e = -heapq.heappop(maxq) - 1
                        if d[e] != 0:
                            d[e] -= 1
                            break
                else:
                    while minq:
                        e = heapq.heappop(minq)
                        if d[e] != 0:
                            d[e] -= 1
                            break
            else:
                n = int(s[2:])
                heapq.heappush(maxq, -n - 1)
                heapq.heappush(minq, n)
                d[n] += 1
        while maxq:
            maxe = -heapq.heappop(maxq) - 1
            if d[maxe] != 0:
                break
        else:
            maxe = None
        while minq:
            mine = heapq.heappop(minq)
            if d[mine] != 0:
                break
        else:
            mine = None
        if maxe == None:
            output.append("EMPTY\n")
        else:
            output.append(str(maxe))
            output.append(' ')
            output.append(str(mine))
            output.append('\n')
    os.write(1, output.build().encode('ascii'))
main()
```

ì•„ì´ë”” | ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B) 
:-----:|:-----:|:-----:|:----:|:--------:
kiwiyou|279892|1732|PyPy3|1631