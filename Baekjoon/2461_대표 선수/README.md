# [2461] ëŒ€í‘œ ì„ ìˆ˜

### **ë‚œì´ë„**
ê³¨ë“œ 2
## **ğŸ“ë¬¸ì œ**
KOI ì¤‘í•™êµì—ëŠ” Nê°œì˜ í•™ê¸‰ì´ ìˆìœ¼ë©°, ê° í•™ê¸‰ì˜ í•™ìƒ ìˆ˜ëŠ” ëª¨ë‘ Mëª…ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. ì´ ì¤‘í•™êµì—ì„œëŠ” ì²´ìœ¡ëŒ€íšŒì— ìƒˆë¡œìš´ ì¢…ëª©ì˜ ê²½ê¸°ë¥¼ ì¶”ê°€í•˜ì˜€ë‹¤. ì´ ê²½ê¸°ì— ëŒ€í•´ ëª¨ë“  í•™ìƒë“¤ì€ ì €ë§ˆë‹¤ì˜ ëŠ¥ë ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ëŠ¥ë ¥ì¹˜ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ì´ ëŠ¥ë ¥ì¹˜ëŠ” ëª¨ë“  í•™ìƒì´ ì„œë¡œ ë‹¤ë¥´ë‹¤.

ì´ ê²½ê¸°ëŠ” í•œë°˜ì—ì„œ í•œ ëª…ì˜ ëŒ€í‘œì„ ìˆ˜ë¥¼ ì„ ë°œí•˜ì—¬ ì¹˜ë¥¸ë‹¤. ê²½ê¸°ì˜ í˜•í‰ì„±ì„ ìœ„í•˜ì—¬, ê°ê°ì˜ ë°˜ì—ì„œ ëŒ€í‘œë¡œ ì„ ë°œëœ ëª¨ë“  í•™ìƒë“¤ì˜ ëŠ¥ë ¥ì¹˜ ì¤‘ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì˜ ì°¨ì´ê°€ ìµœì†Œê°€ ë˜ë„ë¡ ì„ ìˆ˜ë¥¼ ì„ ë°œí•˜ë ¤ê³  í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, N=3, M=4ì¸ ê²½ìš° í•™ìƒë“¤ì˜ ëŠ¥ë ¥ì¹˜ê°€ 1ë°˜=[12, 16, 67, 43],  2ë°˜=[7, 17, 68, 48], 3ë°˜=[14, 15, 77, 54]ë¡œ ì£¼ì–´ì§ˆ ë•Œ, ê° í•™ê¸‰ìœ¼ë¡œë¶€í„° ëŠ¥ë ¥ì¹˜ 16, 17, 15ë¥¼ ê°€ì§„ í•™ìƒì„ ê°ê° ì„ íƒí•˜ë©´, ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì˜ ì°¨ì´ê°€ 17-15=2ë¡œ ìµœì†Œê°€ ëœë‹¤. 

ëŒ€í‘œë¡œ ì„ ë°œëœ ëª¨ë“  í•™ìƒë“¤ ëŠ¥ë ¥ì¹˜ì˜ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ ì°¨ì´ê°€ ìµœì†Œê°€ ë˜ëŠ” ê²½ìš°ì˜ ê°’ì„ ì¶œë ¥í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.
### **ì…ë ¥**
ì…ë ¥ì˜ ì²« ë²ˆì§¸ ì¤„ì—ëŠ” í•™ê¸‰ì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Nê³¼ ê° í•™ê¸‰ì˜ í•™ìƒì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Mì´ í•˜ë‚˜ì˜ ë¹ˆì¹¸ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§„ë‹¤. ë‹¨, 1 â‰¤ N, M â‰¤ 1,000ì´ë‹¤. ë‘ ë²ˆì§¸ ì¤„ë¶€í„° Nê°œì˜ ì¤„ì—ëŠ” ê° ì¤„ë§ˆë‹¤ í•œ í•™ê¸‰ í•™ìƒë“¤ì˜ ëŠ¥ë ¥ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Mê°œì˜ ì–‘ì˜ ì •ìˆ˜ê°€ í•˜ë‚˜ì˜ ë¹ˆì¹¸ì„ ì‚¬ì´ì— ë‘ê³  ì£¼ì–´ì§„ë‹¤. ëŠ¥ë ¥ì¹˜ëŠ” 0ì´ìƒ 109ì´í•˜ì´ë‹¤.
### **ì¶œë ¥**
ëŒ€í‘œë¡œ ì„ ë°œëœ ëª¨ë“  í•™ìƒë“¤ ëŠ¥ë ¥ì¹˜ì˜ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ ì°¨ì´ê°€ ìµœì†Œê°€ ë˜ëŠ” ê²½ìš°ì˜ ê°’ì„ í•˜ë‚˜ì˜ ì •ìˆ˜ë¡œ ì¶œë ¥í•œë‹¤.
### **ì˜ˆì œì…ì¶œë ¥**

**ì˜ˆì œ ì…ë ¥1**

```
3 4
12 16 67 43
7 17 68 48
14 15 77 54
```

**ì˜ˆì œ ì¶œë ¥1**

```
2
```

**ì˜ˆì œ ì…ë ¥2**

```
4 3
10 20 30
40 50 60
70 80 90
100 110 120
```

**ì˜ˆì œ ì¶œë ¥2**

```
70
```
### **ì¶œì²˜**

## **ğŸ§CODE REVIEW**

### **ğŸ§¾ë‚˜ì˜ í’€ì´**

```python
import sys

N, M = map(int, sys.stdin.readline().rstrip().split())
arr = []
for class_id in range(N):
    team = list(map(int, sys.stdin.readline().rstrip().split()))

    for value in team:
        arr.append((value, class_id))
    
arr.sort(key=lambda x: x[0])

count = [0] * N
covered = 0
answer = int(10e9)

left = 0
for right in range(len(arr)):
    value_right, class_right = arr[right]

    if count[class_right] == 0:
        covered += 1
    
    count[class_right] += 1

    while covered == N:
        value_left, class_left = arr[left]
        answer = min(answer, value_right - value_left)

        count[class_left] -= 1
        if count[class_left] == 0:
            covered -= 1
        
        left += 1

if N == 1:
    print(0)
else:
    print(answer)
```

ê²°ê³¼	| ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B)
:----:|:-----:|:-----:|:-----:|:--------:
ì •ë‹µ|144036|1804|Python3|770
#### **ğŸ“í•´ì„¤**

**ì•Œê³ ë¦¬ì¦˜**
```
1. íˆ¬ í¬ì¸í„°
2. ìµœì†Œ í™
```

### **ë‹¤ë¥¸ í’€ì´**

```python
"""

"""
import sys, heapq

fin = sys.stdin.read().split('\n')
n_class, n_student = map(int, fin[0].split())
ability = []
for idx in range(1,1+n_class):
    ability.append(list(map(int, fin[idx].split())))

def solve(n_class: int, n_student: int, ability: list[list[int]]):
    for abty in ability: abty.sort()

    idx = [0 for _ in range(n_class)]
    heap = [(ability[src][0], src) for src in range(n_class)]
    heapq.heapify(heap)
    heap_max = max(heap, key=lambda s: s[0])[0]

    ans = 1000000001

    while heap:
        heap_min, src = heapq.heappop(heap)
        ans = min(ans, heap_max - heap_min)

        idx[src] += 1
        if idx[src] == n_student: break

        heapq.heappush(heap, (ability[src][idx[src]], src))
        heap_max = max(heap_max, ability[src][idx[src]])

    return ans

print(solve(n_class, n_student, ability))

```

ì•„ì´ë”” | ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B) 
:-----:|:-----:|:-----:|:----:|:--------:
irhi_2077|148620|624|PyPy3|851
#### **ğŸ“í•´ì„¤**

```python
import sys

# ì…ë ¥ë°›ê¸°
N, M = map(int, sys.stdin.readline().rstrip().split())

# ëª¨ë“  í•™ìƒë“¤ì˜ ì ìˆ˜ë¥¼ í•œ ë¦¬ìŠ¤íŠ¸ì— ì €ì¥
arr = []
for class_id in range(N):
    team = list(map(int, sys.stdin.readline().rstrip().split()))

    # (ì ìˆ˜, ë°˜)ì´ ë˜ë„ë¡ ì €ì¥
    for value in team:
        arr.append((value, class_id))

# í•™ìƒì„ ì ìˆ˜ë³„ë¡œ ì •ë ¬
arr.sort(key=lambda x: x[0])


# íˆ¬ í¬ì¸í„°ë¥¼ í†µí•´ ëª¨ë“  í•™ìƒë“¤ì„ í¬í•¨í•˜ë©´ì„œ, ê° ë°˜ì—ì„œ ëª‡ëª…ì´ ë½‘í˜”ëŠ”ì§€ ê²€ì‚¬

# ê° ë°˜ì—ì„œ ëª‡ ëª…ì´ í¬í•¨ëëŠ”ì§€ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
count = [0] * N

# í˜„ì¬ ëª‡ ë°˜ì´ ê³¨ë¼ì¡ŒëŠ”ì§€ ì €ì¥í•  ë³€ìˆ˜
covered = 0
answer = int(10e9)

# íˆ¬í¬ì¸í„° ì„¤ì •
left = 0

# rightëŠ” 0ì—ì„œë¶€í„° ì‹œì‘
for right in range(len(arr)):

    value_right, class_right = arr[right]

    # ì•„ì§ í¬í•¨ë˜ì§€ ì•Šì•˜ë˜ ë°˜ì´ë¼ë©´ += 1
    if count[class_right] == 0:
        covered += 1
    
    count[class_right] += 1

    # í˜„ì¬ ëª¨ë“  ë°˜ì´ í¬í•¨ëœ ìƒíƒœë¼ë©´
    while covered == N:
        value_left, class_left = arr[left]

        # ìµœì†Œê°’ì´ ê°±ì‹ ì´ ê°€ëŠ¥í•˜ë‹¤ë©´ ê°±ì‹ 
        answer = min(answer, value_right - value_left)

        # leftë¥¼ í•˜ë‚˜ ëŠ˜ë¦¼
        count[class_left] -= 1
        if count[class_left] == 0:
            covered -= 1
        
        left += 1

# ì¶œë ¥
if N == 1:
    print(0)
else:
    print(answer)
```