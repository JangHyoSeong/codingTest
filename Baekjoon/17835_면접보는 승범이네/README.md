# [17835] ë©´ì ‘ë³´ëŠ” ìŠ¹ë²”ì´ë„¤

### **ë‚œì´ë„**
ê³¨ë“œ 2
## **ğŸ“ë¬¸ì œ**
ë§ˆí¬êµ¬ì—ëŠ” ëª¨ë“  ëŒ€í•™ìƒì´ ì…ì‚¬ë¥¼ í¬ë§í•˜ëŠ” êµ´ì§€ì˜ ëŒ€ê¸°ì—… ãˆœìŠ¹ë²”ì´ë„¤ ë³¸ì‚¬ê°€ ìë¦¬ë¥¼ ì¡ê³  ìˆë‹¤. ìŠ¹ë²”ì´ëŠ” ãˆœìŠ¹ë²”ì´ë„¤ì˜ ì‚¬ì¥ì¸ë°, ì¼ì„ ëª» í•˜ëŠ” ì§ì›ë“¤ì—ê²Œ í™”ê°€ ë‚œ ë‚˜ë¨¸ì§€ ì „ ì§ì›ì„ í•´ê³ í•˜ê³  ì‹ ì…ì‚¬ì›ì„ ë½‘ìœ¼ë ¤ í•œë‹¤. 1ì°¨ ì„œë¥˜ì „í˜•ì´ ëë‚œ ë’¤ í•©ê²©ìë“¤ì€ ë©´ì ‘ì„ ì¤€ë¹„í•˜ê²Œ ë˜ì—ˆë‹¤.

ë©´ì ‘ìë“¤ì€ ì„œë¡œ ë‹¤ë¥¸ Nê°œì˜ ë„ì‹œì— ê±°ì£¼í•œë‹¤. ìŠ¹ë²”ì´ëŠ” ë©´ì ‘ìë“¤ì˜ í¸ì˜ë¥¼ ìœ„í•´ ê±°ì£¼ ì¤‘ì¸ Nê°œ ë„ì‹œ ì¤‘ Kê°œì˜ ë„ì‹œì— ë©´ì ‘ì¥ì„ ë°°ì¹˜í–ˆë‹¤. ë„ì‹œë¼ë¦¬ëŠ” ë‹¨ë°©í–¥ ë„ë¡œë¡œ ì—°ê²°ë˜ë©°, ê±°ë¦¬ëŠ” ì„œë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. ì–´ë–¤ ë‘ ë„ì‹œ ì‚¬ì´ì—ëŠ” ë„ë¡œê°€ ì—†ì„ ìˆ˜ë„, ì—¬ëŸ¬ ê°œê°€ ìˆì„ ìˆ˜ë„ ìˆë‹¤. ë˜í•œ ì–´ë–¤ ë„ì‹œì—ì„œë“  ì ì–´ë„ í•˜ë‚˜ì˜ ë©´ì ‘ì¥ê¹Œì§€ ê°ˆ ìˆ˜ ìˆëŠ” ê²½ë¡œê°€ í•­ìƒ ì¡´ì¬í•œë‹¤.

ëª¨ë“  ë©´ì ‘ìëŠ” ë³¸ì¸ì˜ ë„ì‹œì—ì„œ ì¶œë°œí•˜ì—¬ ê°€ì¥ ê°€ê¹Œìš´ ë©´ì ‘ì¥ìœ¼ë¡œ ì°¾ì•„ê°ˆ ì˜ˆì •ì´ë‹¤. ì¦‰, ì•„ë˜ì—ì„œ ì–¸ê¸‰ë˜ëŠ” 'ë©´ì ‘ì¥ê¹Œì§€ì˜ ê±°ë¦¬'ë€ ê·¸ ë„ì‹œì—ì„œ ë„ë‹¬ ê°€ëŠ¥í•œ ê°€ì¥ ê°€ê¹Œìš´ ë©´ì ‘ì¥ê¹Œì§€ì˜ ìµœë‹¨ ê±°ë¦¬ë¥¼ ëœ»í•œë‹¤.

ì†ì´ˆ ì¶œì‹  ìŠ¹ë²”ì´ëŠ” ì§€ë°©ì˜ ì„œëŸ¬ì›€ì„ ì•Œê¸°ì— ê° ë„ì‹œì—ì„œ ë©´ì ‘ì¥ê¹Œì§€ì˜ ê±°ë¦¬ ì¤‘, ê·¸ ê±°ë¦¬ê°€ ê°€ì¥ ë¨¼ ë„ì‹œì—ì„œ ì˜¤ëŠ” ë©´ì ‘ìì—ê²Œ êµí†µë¹„ë¥¼ ì£¼ë ¤ê³  í•œë‹¤.

ìŠ¹ë²”ì´ë¥¼ ìœ„í•´ ë©´ì ‘ì¥ê¹Œì§€ì˜ ê±°ë¦¬ê°€ ê°€ì¥ ë¨¼ ë„ì‹œì™€ ê·¸ ê±°ë¦¬ë¥¼ êµ¬í•´ë³´ë„ë¡ í•˜ì.
### **ì…ë ¥**
ì²«ì§¸ ì¤„ì— ë„ì‹œì˜ ìˆ˜ N(2 â‰¤ N â‰¤ 100,000), ë„ë¡œì˜ ìˆ˜ M(1 â‰¤ M â‰¤ 500,000), ë©´ì ‘ì¥ì˜ ìˆ˜ K(1 â‰¤ K â‰¤ N)ê°€ ê³µë°±ì„ ë‘ê³  ì£¼ì–´ì§„ë‹¤. ë„ì‹œëŠ” 1ë²ˆë¶€í„° Në²ˆê¹Œì§€ì˜ ê³ ìœ í•œ ë²ˆí˜¸ê°€ ë§¤ê²¨ì§„ë‹¤.

ë‹¤ìŒ Mê°œì˜ ì¤„ì— ê±¸ì³ í•œ ì¤„ë§ˆë‹¤ ë„ì‹œì˜ ë²ˆí˜¸ U, V(U â‰  V)ì™€ ë„ë¡œì˜ ê¸¸ì´ C(1 â‰¤ C â‰¤ 100,000)ê°€ ê³µë°±ì„ ë‘ê³  ìˆœì„œëŒ€ë¡œ ì£¼ì–´ì§„ë‹¤. ì´ëŠ” ë„ì‹œ Uì—ì„œ Vë¡œ ê°ˆ ìˆ˜ ìˆëŠ” ë„ë¡œê°€ ì¡´ì¬í•˜ê³ , ê·¸ ê±°ë¦¬ê°€ Cë¼ëŠ” ëœ»ì´ë‹¤.

ë§ˆì§€ë§‰ ì¤„ì— ë©´ì ‘ì¥ì´ ë°°ì¹˜ëœ ë„ì‹œì˜ ë²ˆí˜¸ Kê°œê°€ ê³µë°±ì„ ë‘ê³  ì£¼ì–´ì§„ë‹¤.
### **ì¶œë ¥**
ì²«ì§¸ ì¤„ì— ë©´ì ‘ì¥ê¹Œì§€ ê±°ë¦¬ê°€ ê°€ì¥ ë¨¼ ë„ì‹œì˜ ë²ˆí˜¸ë¥¼ ì¶œë ¥í•œë‹¤. ë§Œì•½ ê·¸ëŸ° ë„ì‹œê°€ ì—¬ëŸ¬ ê³³ì´ë©´ ê°€ì¥ ì‘ì€ ë²ˆí˜¸ë¥¼ ì¶œë ¥í•œë‹¤.

ë‘˜ì§¸ ì¤„ì— í•´ë‹¹ ë„ì‹œì—ì„œ ë©´ì ‘ì¥ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ì¶œë ¥í•œë‹¤.
### **ì˜ˆì œì…ì¶œë ¥**

**ì˜ˆì œ ì…ë ¥1**

```
6 10 2
2 6 2
1 4 1
6 1 5
2 5 1
5 1 4
4 5 6
6 2 3
3 5 1
3 1 1
5 2 2
1 2
```

**ì˜ˆì œ ì¶œë ¥1**

```
4
8
```

**ì˜ˆì œ ì…ë ¥2**

```
10 20 5
4 1 18
6 1 7
2 4 1
5 6 18
7 6 10
10 6 9
3 2 4
8 3 10
9 8 15
7 1 12
10 7 1
8 1 3
6 5 19
2 9 10
7 2 4
10 3 20
7 10 14
5 7 12
8 4 10
2 5 8
1 8 4 6 7
```

**ì˜ˆì œ ì¶œë ¥2**

```
9
15
```
### **ì¶œì²˜**

## **ğŸ§CODE REVIEW**

### **ğŸ§¾ë‚˜ì˜ í’€ì´**

```python
import sys
from heapq import heappush, heappop

INF = float('inf')

N, M, K = map(int, sys.stdin.readline().rstrip().split())
edges = [[] for _ in range(N+1)]

for _ in range(M):
    u, v, c = map(int, sys.stdin.readline().rstrip().split())
    edges[v].append((c, u))

cities = list(map(int, sys.stdin.readline().rstrip().split()))

pq = []
dist = [INF] * (N+1)
for city in cities:
    dist[city] = 0
    heappush(pq, (0, city))

while pq:
    cost, now = heappop(pq)
    if cost > dist[now]:
        continue

    for next_cost, next_city in edges[now]:
        new_cost = next_cost + cost

        if dist[next_city] > new_cost:
            dist[next_city] = new_cost
            heappush(pq, (new_cost, next_city))

max_dist = -1
city_num = -1

for i in range(1, N+1):
    if dist[i] > max_dist:
        max_dist = dist[i]
        city_num = i

print(city_num)
print(max_dist)
```

ê²°ê³¼	| ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B)
:----:|:-----:|:-----:|:-----:|:--------:
ì •ë‹µ|155916|960|PyPy3|880
#### **ğŸ“í•´ì„¤**

**ì•Œê³ ë¦¬ì¦˜**
```
1. ë‹¤ìµìŠ¤íŠ¸ë¼
```

### **ë‹¤ë¥¸ í’€ì´**

```python
import io, os
import heapq as hq
input = io.BytesIO(os.read(0, os.fstat(0).st_size)).readline
INF = 1<<40
def main():
    N, M, K = map(int, input().split())
    graph = [{} for _ in range(N + 1)]
    dist = [INF] * (N + 1)
    for _ in range(M):
        u, v, c = map(int, input().split())
        if c0:=(graph[v].get(u)) is not None and c0 <= c:
            continue
        graph[v][u] = c
    marked = [*map(int, input().split())]
    que = []
    for m in marked:
        dist[m] = 0
        que.append((0, m))
    ans = 0
    while que:
        d, u = hq.heappop(que)
        if d > dist[u]:
            continue
        ans = d
        for v, w in graph[u].items():
            if d + w < dist[v]:
                dist[v] = d + w
                hq.heappush(que, (d + w, v))
    for i, d in enumerate(dist):
        if d == ans:
            print(i)
            print(ans)
            return
main()
```

ì•„ì´ë”” | ë©”ëª¨ë¦¬(KB) |	ì‹œê°„(ms) |	ì–¸ì–´ |	ì½”ë“œ ê¸¸ì´(B) 
:-----:|:-----:|:-----:|:----:|:--------:
minskai|175856|676|PyPy3|906
#### **ğŸ“í•´ì„¤**

```python
import sys
from heapq import heappush, heappop

# ì„ì˜ì˜ í° ê°’
INF = float('inf')

N, M, K = map(int, sys.stdin.readline().rstrip().split())
edges = [[] for _ in range(N+1)]

# ê°„ì„  ì •ë³´ë¥¼ ì—­ë°©í–¥ìœ¼ë¡œ ì €ì¥(ë„ì°©ì ì—ì„œë¶€í„° ì—­ì¶”ì )
for _ in range(M):
    u, v, c = map(int, sys.stdin.readline().rstrip().split())
    edges[v].append((c, u))

# ë„ì°©ì§€ì ë“¤
cities = list(map(int, sys.stdin.readline().rstrip().split()))

# ë‹¤ìµìŠ¤íŠ¸ë¼ë¥¼ ìœ„í•œ PQ
pq = []

# ë„ì°©ì§€ì ë“¤ê¹Œì§€ì˜ ê±°ë¦¬
dist = [INF] * (N+1)
for city in cities:
    dist[city] = 0

    # ë„ì°©ì ì„ ëª¨ë‘ ìš°ì„ ìˆœìœ„ íì— ì‚½ì…
    heappush(pq, (0, city))

# ë‹¤ìµìŠ¤íŠ¸ë¼ ì‹œì‘
while pq:
    cost, now = heappop(pq)
    if cost > dist[now]:
        continue

    for next_cost, next_city in edges[now]:
        new_cost = next_cost + cost

        if dist[next_city] > new_cost:
            dist[next_city] = new_cost
            heappush(pq, (new_cost, next_city))

# ìµœëŒ€ ê±°ë¦¬, ê·¸ë•Œì˜ ë„ì‹œ ë²ˆí˜¸
max_dist = -1
city_num = -1

for i in range(1, N+1):
    if dist[i] > max_dist:
        max_dist = dist[i]
        city_num = i

print(city_num)
print(max_dist)
```